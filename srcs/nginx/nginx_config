#Redirect to HTTPS
server {
	listen		80;
	listen 		[::]:80;
	return 301 https://$host$request_uri;
}
	
#Main server configuration
server {
	listen		443 ssl;
	listen		[::]:443 ssl;
	index		index.html index.htm;

	#SSL configuration
	ssl_certificate				/etc/ssl/certs/nginx.crt;
	ssl_certificate_key			/etc/ssl/private/nginx.key;
	ssl_protocols				TLSv1 TLSv1.1 TLSv1.2;
	ssl_prefer_server_ciphers	on;
	ssl_ciphers					EECDH:+AES256:-3DES:RSA+AES:RSA+3DES:!NULL:!RC4;

	location /wordpress {
		return 307 http://192.168.99.101:5050;
	}

	location /phpmyadmin/ {
		proxy_set_header X-Forwarded-Proto https;
		proxy_pass http://192.168.99.101:5000/;
	}

	location / {
		autoindex on;
		try_files $uri $uri/ =404;
	}

	location /index.php {
		return 301 http://192.168.99.101/phpmyadmin/;
	}

#	location ~ \.php$ {
#		return 301 http://192.168.99.101/phpmyadmin/;
#		include	fastcgi_params;
#		include	fastcgi.conf;
#		fastcgi_pass 127.0.0.1:9000;
#	}

	location ~ /\.ht {
        deny all;
    }
}
